<header class="flex items-center justify-between w-full fixed top-0 z-40 bg-[var(--color-accent)] md:bg-transparent text-[var(--color-textTitle)] md:text-[var(--color-accent)] bg-opacity-5 shadow-md md:text-sm 2xl:text-xl px-5">
    <!-- Logo -->
    <div class="items-center">
        <a href="/">
            <img class="w-10 h-10 xl:w-12 xl:h-12" src="/MakeWeb_MM.svg" alt="MakeWeb Logo" />
        </a>
    </div>

    <!-- Botón hamburguesa -->
    <button class="lg:hidden p-2 rounded hover:text-[var(--color-primary)]" onclick="window.openMenu()" aria-label="Abrir menú">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
    </button>

    <!-- Menú -->
    <nav id="main-menu" class="hidden absolute top-full left-0 w-full bg-[var(--color-accent)] md:bg-transparent text-[var(--color-accent)] md:text-[var(--color-text)] z-50 flex-col lg:flex lg:flex-row lg:static lg:w-auto lg:items-center lg:gap-6">
        <ul class="flex flex-col lg:flex-row w-full lg:w-auto p-2 md:p-0 space-y-2 md:space-y-0">
            <li><a class="px-4 py-2 -skew-y-2 bg-[var(--color-secondary)] md:bg-transparent flex flex-grow hover:underline hover:text-[var(--color-textTitle)] hover:bg-transparent" href="/">Home</a></li>
            <li><a class="px-4 py-2 -skew-y-2 bg-[var(--color-secondary)] md:bg-transparent flex flex-grow hover:underline hover:text-[var(--color-textTitle)] hover:bg-transparent" href="/aboutme">About Me</a></li>
            <li><a class="px-4 py-2 -skew-y-2 bg-[var(--color-secondary)] md:bg-transparent flex flex-grow hover:underline hover:text-[var(--color-textTitle)] hover:bg-transparent" href="/skills">Skills</a></li>
            <li><a class="px-4 py-2 -skew-y-2 bg-[var(--color-secondary)] md:bg-transparent flex flex-grow hover:underline hover:text-[var(--color-textTitle)] hover:bg-transparent" href="/tecnologies">Technologies</a></li>
        </ul>

        <ul class="flex flex-col lg:flex-row w-full text-[var(--color-textTitle)] md:text-[var(--color-accent)] lg:w-auto p-2 md:p-0">
            <li class="lg:ml-auto"><a class="px-4 py-2 -skew-y-2 flex flex-grow hover:underline hover:bg-[var(--color-primary)] md:bg-[var(--color-secondary)] hover:text-[var(--color-accent)]" href="/connect">Connect</a></li>
        </ul>
    </nav>
    
</header>

<script>
    declare global {
        interface Window {
            openMenu: () => void;
        }
    }

    function openMenu() {
        const menu = document.getElementById('main-menu');
        if (!menu) return;

        const isVisible = !menu.classList.contains('hidden');

        if (isVisible) {
            menu.classList.add('hidden');
            menu.classList.remove('flex');
            document.removeEventListener('click', closeMenuOnOutsideClick);
        } else {
            menu.classList.remove('hidden');
            menu.classList.add('flex');
            setTimeout(() => {
                document.addEventListener('click', closeMenuOnOutsideClick);
            }, 0); // Evita que se cierre inmediatamente por el mismo click del botón
        }
    }

    function closeMenuOnOutsideClick(e: MouseEvent) {
        const menu = document.getElementById('main-menu');
        const button = (e.target as HTMLElement)?.closest('button[aria-label="Abrir menú"]');
        if (menu && !menu.contains(e.target as Node) && !button) {
            menu.classList.add('hidden');
            menu.classList.remove('flex');
            document.removeEventListener('click', closeMenuOnOutsideClick);
        }
    }

    window.openMenu = openMenu;
</script>